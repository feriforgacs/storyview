jQuery(document).ready(function($){let file_frame;$("#ff_storyview_blocks_list").sortable({placeholder:"ui-state-highlight",axis:"y"});let wp_media_post_id=wp.media.model.settings.post.id,set_to_post_id=wp_media_post_id,blockId=0;function setImage(image_url,blockId){$("#ff_storyview_block_item_"+blockId+" .ff_storyview_block_item_preview .ff_storyview_block_item_content").css({"background-image":"url("+image_url+")"}),displayStoryPreview(blockId)}function setTextContent(blockId){let text=$("#ff_storyview_block_item_text_"+blockId).val();$("#ff_storyview_block_item_"+blockId+" .ff_storyview_block_item_content .block_item_text").text(text),displayStoryPreview(blockId)}function setTextPosition(blockId,position){$("#ff_storyview_block_item_"+blockId+" .ff_storyview_block_item_content").removeClass("ff_storyview_text_block_top ff_storyview_text_block_middle ff_storyview_text_block_bottom").addClass(position)}function setTextBackground(blockId){}function setTextColor(blockId){}function setTextFontFamily(blockId){}function setTextFontColor(blockId){}function displayStoryPreview(blockId){$("#ff_storyview_block_item_"+blockId+" .ff_storyview_block_item_preview .preview_text").hide(),$("#ff_storyview_block_item_"+blockId+" .ff_storyview_block_item_preview .ff_storyview_block_item_content").css({display:"flex"})}$("#ff_storyview_blocks_list").on("click",".ff_storyview_image_upload",function(event){if(event.preventDefault(),blockId=$(this).data("blockid"),file_frame)return file_frame.uploader.uploader.param("post_id",set_to_post_id),void file_frame.open();wp.media.model.settings.post.id=set_to_post_id,(file_frame=wp.media.frames.file_frame=wp.media({title:"Select image",button:{text:"Use this image"},multiple:!1})).on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),wp.media.model.settings.post.id=wp_media_post_id,$("#ff_storyview_image_block_"+blockId).val(attachment.url),setImage(attachment.url,blockId)}),file_frame.open()}),$("a.add_media").on("click",function(){wp.media.model.settings.post.id=wp_media_post_id}),$("#ff_storyview_blocks_list").on("keyup",".ff_storyview_block_item_text_textarea",function(){setTextContent($(this).data("blockid"))}),$("#ff_storyview_blocks_list").on("click",".ff_storyview_block_item_text_position_label",function(){let positionValue=$(this).children("input[type=radio]").val(),blockId=$(this).data("blockid");$('.ff_storyview_block_item_text_position_label.activ[data-blockid="'+blockId+'"]').removeClass("activ"),$(this).addClass("activ"),setTextPosition(blockId,positionValue)})});